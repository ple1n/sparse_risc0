Derived from https://github.com/zkmove/smt-circuit